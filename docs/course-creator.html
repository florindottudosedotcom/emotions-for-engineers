<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'self' blob:; style-src 'self' 'sha256-DwDirBHag57VKXmMgLajjqFzjUV+1IAfBuMYnN/Kc28='; img-src 'self' data:; connect-src 'self' http://localhost:11434 https://api.openai.com https://api.anthropic.com https://generativelanguage.googleapis.com https://huggingface.co https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs; font-src 'self'; object-src 'none'; base-uri 'self'; form-action 'self'; worker-src 'self' blob:;">
    <title>Universal Course Creator</title>
    <link rel="stylesheet" href="./assets/css/toastui-editor.min.css" />
    <link rel="stylesheet" href="./course-creator.css" />
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; line-height: 1.6; color: #333; max-width: 800px; margin: 2rem auto; padding: 0 1rem; background-color: #f9f9f9; }
        h1, h2, h3 { color: #2c3e50; }
        .container { background-color: #fff; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        .instructions { background-color: #eaf5ff; border-left: 4px solid #3498db; padding: 1rem; margin-bottom: 2rem; border-radius: 4px; }
        label { display: block; margin-bottom: 0.5rem; font-weight: bold; }
        input[type="text"], textarea { width: 100%; padding: 0.75rem; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; margin-bottom: 1rem; }
        textarea { min-height: 100px; resize: vertical; }
        fieldset { border: 1px solid #ccc; border-radius: 4px; padding: 1rem; margin-bottom: 1rem; }
        legend { font-weight: bold; padding: 0 0.5rem; }
        .lang-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 1rem; }
        .lang-item { display: flex; align-items: center; }
        input[type="checkbox"] { margin-right: 0.5rem; }
        .chapter { border: 1px solid #ddd; padding: 1rem; border-radius: 4px; margin-bottom: 1rem; background-color: #fafafa; }
        .chapter-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
        .btn { padding: 0.75rem 1.5rem; border: none; border-radius: 4px; color: #fff; cursor: pointer; font-size: 1rem; }
        .btn-primary { background-color: #3498db; }
        .btn-primary:hover { background-color: #2980b9; }
        .btn-secondary { background-color: #2ecc71; }
        .btn-secondary:hover { background-color: #27ae60; }
        .btn-danger { background-color: #e74c3c; padding: 0.25rem 0.75rem; }
        .btn-danger:hover { background-color: #c0392b; }
        #download-section { margin-top: 2rem; padding: 1rem; background-color: #f0fff4; border: 1px solid #2ecc71; border-radius: 4px; display: none; }
        .input-group { display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem; }
        .input-group input, .input-group textarea { flex-grow: 1; margin-bottom: 0 !important; }
        .btn-ai { padding: 0.5rem 1rem; }
        .ai-assistant { background-color: #f8f9fa; border: 1px solid #dee2e6; border-radius: 4px; padding: 1rem; margin-top: 1rem; }
        .ai-assistant h4 { margin-top: 0; }
        #ai-status { margin: 1rem 0; padding: 1rem; background-color: #fefae0; border: 1px solid #f0ad4e; border-radius: 4px; white-space: pre-wrap; display: none; }
        .header-container { display: flex; justify-content: space-between; align-items: center; }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); display: none; justify-content: center; align-items: center; z-index: 1000; }
        .modal-content { background-color: #fff; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); width: 90%; max-width: 500px; }
        .modal-content.hidden { display: none; }
        .modal-overlay.visible { display: flex; }
    </style>
</head>
<body>

    <div id="settings-modal" class="modal-overlay">
        <div class="modal-content">
            <h2>Cloud API Settings</h2>
            <p>Enter your API keys to use cloud providers. <strong>Keys are only used for this session and are not stored permanently.</strong></p>
            <form id="api-keys-form">
                <label for="openai-api-key">OpenAI API Key</label>
                <input type="password" id="openai-api-key" placeholder="sk-...">

                <label for="anthropic-api-key">Anthropic API Key</label>
                <input type="password" id="anthropic-api-key" placeholder="sk-ant-...">

                <label for="google-api-key">Google Gemini API Key</label>
                <input type="password" id="google-api-key" placeholder="AIzaSy...">

                <div class="input-group margin-top-1-5rem">
                    <button type="submit" class="btn btn-primary">Use Keys for Session</button>
                    <button type="button" id="close-settings-btn" class="btn btn-danger margin-left-auto">Close</button>
                </div>
            </form>
        </div>
    </div>

    <div class="container">
        <div class="header-container">
            <h1>Universal Course Creator</h1>
            <button type="button" id="settings-btn" class="btn btn-secondary">Settings</button>
        </div>
        <div id="ai-status" class="ai-status-initial"></div>

        <div class="instructions">
            <h3>How to Use This Tool</h3>
            <ol>
                <li>Make sure Ollama is running on your computer and you have downloaded a model (e.g., `ollama pull llama3`).</li>
                <li>Enter a topic for your course below and select the number of chapters.</li>
                <li>Click "Generate Course". The AI will populate the course details and chapters for you.</li>
                <li>Review and edit the generated content as needed.</li>
                <li>Select the languages you want to translate the course into.</li>
                <li>Click "Generate Course Files". This will create a .zip file with all the markdown files.</li>
                <li><strong>Security Note:</strong> When downloading new versions of this tool from the releases page, always verify the checksums of the downloaded assets to ensure they have not been tampered with.</li>
            </ol>
        </div>

        <fieldset>
            <legend>AI Provider</legend>
            <div class="input-group">
                <label for="ai-provider-select" class="label-no-shrink-no-margin">Provider:</label>
                <select id="ai-provider-select" class="select-no-margin"></select>
            </div>
            <div class="input-group hidden" id="ai-model-selection-group">
                <label for="ai-model-select" class="label-no-shrink-no-margin">Model:</label>
                <select id="ai-model-select" class="select-no-margin"></select>
                <button type="button" id="refresh-models-btn" class="btn btn-secondary">Refresh List</button>
            </div>
            <div id="ollama-status" class="ollama-status-style"></div>
        </fieldset>

        <fieldset>
            <legend>Master AI Assistant</legend>
            <label for="master-prompt">Course Prompt</label>
            <textarea id="master-prompt" placeholder="e.g., 'Create a comprehensive course about the history of ancient Rome, from its founding to the fall of the Western Empire.'"></textarea>
            <div class="input-group">
                <label for="num-chapters" class="label-no-shrink-no-margin">Number of Chapters:</label>
                <select id="num-chapters" class="select-no-margin">
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5" selected>5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                </select>
                <button type="button" id="generate-course-btn" class="btn btn-secondary margin-left-1rem">Generate Entire Course</button>
            </div>
        </fieldset>

        <hr class="hr-margin">

        <form id="course-form">
            <h2>Course Details</h2>
            <label for="course-name">Course Name</label>
            <input type="text" id="course-name" placeholder="Generated by AI" required>

            <label for="course-desc">Course Description (for main landing page)</label>
            <textarea id="course-desc" placeholder="Generated by AI" required></textarea>

            <h2>Chapters</h2>
            <div id="chapters-container">
                <!-- Chapters will be dynamically added here by the master AI or manually -->
            </div>
            <div class="input-group">
                <button type="button" id="add-chapter" class="btn btn-secondary">Add Chapter Manually</button>
                <button type="button" id="clear-form-btn" class="btn btn-danger margin-left-auto">Clear Form & Start New</button>
            </div>

            <fieldset class="margin-top-2rem">
                <legend>Course Languages</legend>
                <div class="lang-grid">
                    <div class="lang-item" title="English">
                        <input type="checkbox" id="lang-en" value="en" data-name="English" checked>
                        <img src="./assets/images//us.svg" alt="USA Flag" class="flag-icon">
                        <label for="lang-en" class="label-flex-grow">‚≠ê English</label>
                    </div>
                    <div class="lang-item" title="German">
                        <input type="checkbox" id="lang-de" value="de" data-name="German">
                        <img src="./assets/images//de.svg" alt="German Flag" class="flag-icon">
                        <label for="lang-de" class="label-flex-grow">German</label>
                    </div>
                    <div class="lang-item" title="Mandarin Chinese">
                        <input type="checkbox" id="lang-zh" value="zh" data-name="Mandarin Chinese">
                        <img src="./assets/images//cn.svg" alt="Chinese Flag" class="flag-icon">
                        <label for="lang-zh" class="label-flex-grow">Mandarin Chinese</label>
                    </div>
                    <div class="lang-item" title="Spanish">
                        <input type="checkbox" id="lang-es" value="es" data-name="Spanish">
                        <img src="./assets/images//es.svg" alt="Spanish Flag" class="flag-icon">
                        <label for="lang-es" class="label-flex-grow">Spanish</label>
                    </div>
                    <div class="lang-item" title="Hindi">
                        <input type="checkbox" id="lang-hi" value="hi" data-name="Hindi">
                        <img src="./assets/images//in.svg" alt="Indian Flag" class="flag-icon">
                        <label for="lang-hi" class="label-flex-grow">Hindi</label>
                    </div>
                    <div class="lang-item" title="Portuguese">
                        <input type="checkbox" id="lang-pt" value="pt" data-name="Portuguese">
                        <img src="./assets/images//pt.svg" alt="Portuguese Flag" class="flag-icon">
                        <label for="lang-pt" class="label-flex-grow">Portuguese</label>
                    </div>
                    <div class="lang-item" title="Russian">
                        <input type="checkbox" id="lang-ru" value="ru" data-name="Russian">
                        <img src="./assets/images//ru.svg" alt="Russian Flag" class="flag-icon">
                        <label for="lang-ru" class="label-flex-grow">Russian</label>
                    </div>
                    <div class="lang-item" title="Japanese">
                        <input type="checkbox" id="lang-ja" value="ja" data-name="Japanese">
                        <img src="./assets/images//jp.svg" alt="Japanese Flag" class="flag-icon">
                        <label for="lang-ja" class="label-flex-grow">Japanese</label>
                    </div>
                    <div class="lang-item" title="French">
                        <input type="checkbox" id="lang-fr" value="fr" data-name="French">
                        <img src="./assets/images//fr.svg" alt="French Flag" class="flag-icon">
                        <label for="lang-fr" class="label-flex-grow">French</label>
                    </div>
                    <div class="lang-item" title="Italian">
                        <input type="checkbox" id="lang-it" value="it" data-name="Italian">
                        <img src="./assets/images//it.svg" alt="Italian Flag" class="flag-icon">
                        <label for="lang-it" class="label-flex-grow">Italian</label>
                    </div>
                    <div class="lang-item" title="Romanian">
                        <input type="checkbox" id="lang-ro" value="ro" data-name="Romanian">
                        <img src="./assets/images//ro.svg" alt="Romanian Flag" class="flag-icon">
                        <label for="lang-ro" class="label-flex-grow">Romanian</label>
                    </div>
                </div>
            </fieldset>

            <hr class="hr-margin">

            <button type="submit" class="btn btn-primary">Generate Course Files</button>
        </form>

        <div id="download-section">
            <h3>Downloads</h3>
            <p>Your files have been generated. Download them below.</p>
            <a id="download-zip" class="btn btn-primary">Download Course Files (.zip)</a>
        </div>
    </div>

    <!--
    THIRD-PARTY LIBRARIES
    ---------------------
    This application uses the following open-source libraries.

    1. JSZip
       - Version: 3.10.1
       - Path: ./assets/jszip/3.10.1/jszip.min.js
       - License: MIT / GPLv3
       - Website: https://stuk.github.io/jszip/

    2. js-yaml
       - Version: 4.1.0
       - Path: ./assets/js-yaml/4.1.0/js-yaml.min.js
       - License: MIT
       - Website: https://github.com/nodeca/js-yaml

    3. Toast UI Editor
       - Version: Not specified in file path.
       - Path: ./assets/toastui-editor-all.min.js
       - License: MIT
       - Website: https://ui.toast.com/tui-editor

    4. WebLLM
       - Version: 0.2.27
       - Path: ./assets/vendor/webllm/webllm.js
       - License: Apache 2.0
       - Website: https://webllm.mlc.ai/
    -->
    <!-- JS Libraries -->
    <script src="./assets/js/jszip/3.10.1/jszip.min.js"></script>
    <script src="./assets/js/js-yaml/4.1.0/js-yaml.min.js"></script>
    <script src="./assets/js/toastui-editor-all.min.js"></script>

    <!-- Main Application Logic -->
    <script type="module" src="./course-creator.js"></script>

</body>
</html>
